# 連作短歌作成タスク
# 使用方法: e8 run --config examples/tanka-chain.yaml
#
# このタスクは「緩いcriteria + 厳しいjudgment」パターンの例です。
# 連作としての一貫性が要求されるため、複数イテレーションが必要になります。

task: "「月」をテーマに3首の連作短歌を作成する"

# criteria は緩め
criteria:
  - "3首の短歌が作成されている"
  - "各首が5-7-5-7-7の形式になっている"
  - "月に関連する表現が含まれている"

max_iterations: 6
history_context_size: 3

# judgment は厳しく
prompts:
  judgment: |
    以下の観点で厳密に評価し、すべて満たさなければ is_complete=false：

    【形式チェック】
    - 31音を厳密にカウント（拗音・長音・促音の扱いに注意）
    - 上の句（5-7-5）と下の句（7-7）の区切りが明確か

    【連作としての一貫性】
    - 1首目→2首目→3首目で時間経過や心情変化があるか
    - 3首を通して一つの物語として読めるか
    - 単なる「月」の3回繰り返しではなく、展開があるか

    【文体の統一】
    - 文語調・口語調が混在していないか
    - 現代短歌として自然な表現か、古典的すぎないか

    【詩的表現】
    - 説明的でなく、余韻や想像の余地があるか
    - 比喩や象徴が効果的に使われているか

    不十分な首については、具体的な改善案を suggested_next_action で示してください。
